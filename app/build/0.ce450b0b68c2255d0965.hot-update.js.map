{"version":3,"file":"0.ce450b0b68c2255d0965.hot-update.js","sources":["webpack:///src/routes/My.js"],"sourcesContent":["import React, { Component } from \"react\";\nimport \"isomorphic-unfetch\";\nimport * as Styled from \"./styled/Page.js\";\nimport Layout from \"components/Layout.js\";\nimport Results from \"components/search/Results__new\";\n/*\n    components\n*/\nclass Search extends Component {\n\tstatic async getInitialProps({ match }) {\n\t\t/*\n\t\t\tprops modified and propagated by SSR\n\t\t*/\n\t\tconst props = {\n\t\t\tarea_key: match.params.area_key || \"us\",\n\t\t\titems: []\n\t\t};\n\t\t/*\n\t\t\tfetch content - initial data\n\t\t*/\n\t\ttry {\n\t\t\t// fetch from CDN\n\t\t\tconst res = await fetch(`https://d3rinrx0dlc7zz.cloudfront.net/api/v1/jobs/${props.area_key}-50.json`); // Cloudfront CDN => data\n\t\t\tconst data = await res.json();\n\t\t\t// convert to object\n\t\t\tconst items_object = {};\n\t\t\tdata.forEach(function(item) {\n\t\t\t\titems_object[item._id] = item;\n\t\t\t});\n\t\t\t// done converting, use {items_object}\n\t\t\tprops.items = items_object;\n\t\t\treturn props;\n\t\t} catch (e) {\n\t\t\ttry {\n\t\t\t\t// fetch from API (failover)\n\t\t\t\tconst res = await fetch(`http://localhost:1080/api/v1/jobs/${props.area_key}.json?limit=50`); // local API => json.data\n\t\t\t\tconst json = await res.json();\n\t\t\t\t// convert to object\n\t\t\t\tconst items_object = {};\n\t\t\t\tjson.data.forEach(function(item) {\n\t\t\t\t\titems_object[item._id] = item;\n\t\t\t\t});\n\t\t\t\t// done converting, use {items_object}\n\t\t\t\tprops.items = items_object;\n\t\t\t\treturn props;\n\t\t\t} catch (e) {\n\t\t\t\treturn props;\n\t\t\t}\n\t\t}\n\t}\n\t/*\n\t\tinitial data in {this.props.items}, more complete data in {this.state.items}\n\t*/\n\tconstructor() {\n\t\tsuper();\n\t\tthis.state = {\n\t\t\titems: [],\n\t\t\tisLoading: false\n\t\t};\n\t}\n\tasync updateContent(props = {}) {\n\t\tif (!props.area_key) {\n\t\t\treturn;\n\t\t}\n\t\tthis.setState({ isLoading: true });\n\t\t/*\n\t\t\tfetch content - all data\n\t\t*/\n\t\ttry {\n\t\t\t// fetch from CDN\n\t\t\tconst res = await fetch(`https://d3rinrx0dlc7zz.cloudfront.net/api/v1/jobs/${props.area_key}.json`); // Cloudfront CDN => data\n\t\t\tconst data = await res.json();\n\t\t\t// convert to object\n\t\t\tconst items_object = {};\n\t\t\tdata.forEach(function(item) {\n\t\t\t\titems_object[item._id] = item;\n\t\t\t});\n\t\t\t// done converting, use {items_object}\n\t\t\tthis.setState({ items: items_object, isLoading: false });\n\t\t} catch (e) {\n\t\t\ttry {\n\t\t\t\t// fetch from API (failover)\n\t\t\t\tconst res = await fetch(`http://localhost:1080/api/v1/jobs/${props.area_key}.json`); // local API => json.data\n\t\t\t\tconst json = await res.json();\n\t\t\t\t// convert to object\n\t\t\t\tconst items_object = {};\n\t\t\t\tjson.data.forEach(function(item) {\n\t\t\t\t\titems_object[item._id] = item;\n\t\t\t\t});\n\t\t\t\t// done converting, use {items_object}\n\t\t\t\tthis.setState({ items: items_object, isLoading: false });\n\t\t\t} catch (e) {}\n\t\t}\n\t}\n\tcomponentWillReceiveProps(props = {}) {\n\t\t/*\n\t\t\tupdate Content - when page route changed\n\t\t*/\n\t\tif (props.items && props.items.length) {\n\t\t\t/*\n\t\t\t\tfirst - throw out old state and replace with new props\n\t\t\t*/\n\t\t\tthis.setState({ items: props.items });\n\t\t\t/*\n\t\t\t\tthen - fetch the rest\n\t\t\t*/\n\t\t\t// this.updateContent(props);\n\t\t}\n\t}\n\tcomponentDidMount() {\n\t\t/*\n\t\t\tupdate Content - only initial page load after page SSR'd with getInitialProps()\n\t\t*/\n\t\tif (!this.state.items.length && this.props.area_key) {\n\t\t\t// this.updateContent(this.props);\n\t\t}\n\t}\n\n\trender() {\n\t\t/*\n\t\t\tthis.props || this.state\n\t\t*/\n\t\tconst items = this.state.items.length ? this.state.items : this.props.items;\n\t\treturn (\n\t\t\t<Layout>\n\t\t\t\t<Styled.Page className={\"Page \" + (this.state.isLoading ? \" isLoading\" : \"\")}>\n\t\t\t\t\t<Results area_key={this.props.area_key || \"us\"} items={items || {}} className={this.state.isLoading ? \" isLoading\" : \"\"} />\n\t\t\t\t</Styled.Page>\n\t\t\t</Layout>\n\t\t);\n\t}\n}\n\nexport default Search;\n\n\n\n// WEBPACK FOOTER //\n// src/routes/My.js"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;;;;AAGA;;;;;;;AACA;AACA;;;;;;;AAAA;;;AAGA;AACA;AACA;AAFA;AAIA;;;;;;AAKA;AACA;;AADA;;AACA;AACA;;AADA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;AAGA;AACA;;AADA;;AACA;AACA;;AADA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AACA;AACA;;;;;;;;;;;;;;;AAGA;;;;;;AAGA;AAAA;AACA;AADA;AACA;AACA;AACA;AACA;AAFA;AAFA;AAMA;AACA;;;;;AAAA;AACA;;;;;;;AAAA;;;;;;;;AAGA;AACA;;;;;AAKA;AACA;;AADA;;AACA;AACA;;AADA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;;;;;;;;;AAIA;AACA;;AADA;;AACA;AACA;;AADA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;AAIA;AAAA;AACA;AAAA;;;AAGA;AACA;;;AAGA;AACA;;;AAGA;AACA;AACA;;;AACA;AACA;;;AAGA;AACA;AACA;AACA;;;AAEA;AACA;;;AAGA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AADA;AADA;AAMA;;;;AA1HA;AACA;AA4HA;;;;A","sourceRoot":""}